<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Chat - LinkTour</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* --- GERAL --- */
body { margin: 0; font-family: 'Inter', Arial, sans-serif; background-color: #fff; height: 100vh; overflow: hidden; color: #333; }

/* --- LISTA DE CONVERSAS (INBOX) --- */
#tela-inbox { height: 100%; display: flex; flex-direction: column; }

.header-inbox {
    padding: 20px; display: flex; justify-content: space-between; align-items: center;
    border-bottom: 1px solid #eee; background: #fff;
}
.header-inbox h2 { margin: 0; font-size: 20px; }

.icon-header { width: 24px; height: 24px; opacity: 0.6; cursor: pointer; }

.lista-chats { flex: 1; overflow-y: auto; }

.chat-item {
    display: flex; align-items: center; padding: 15px 20px;
    border-bottom: 1px solid #f9f9f9; cursor: pointer; transition: background 0.2s;
}
.chat-item:hover { background-color: #f5f5f5; }

.avatar { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; margin-right: 15px; background: #eee; }
.chat-info { flex: 1; }
.chat-nome { font-weight: 600; font-size: 15px; color: #000; margin-bottom: 4px; }
.chat-preview { font-size: 13px; color: #888; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }
.chat-meta { font-size: 11px; color: #aaa; display: flex; flex-direction: column; align-items: flex-end; }
.badge { background: #e60050; color: #fff; font-size: 10px; font-weight: bold; padding: 2px 6px; border-radius: 10px; margin-top: 5px; }

/* --- SALA DE BATE-PAPO (CONVERSA) --- */
#tela-conversa {
    display: none; height: 100%; flex-direction: column; background-color: #fff;
    position: absolute; top: 0; left: 0; width: 100%; z-index: 100;
}

.chat-header {
    display: flex; align-items: center; padding: 10px 15px;
    border-bottom: 1px solid #eee; background: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.02);
}
.btn-voltar { background: none; border: none; font-size: 24px; cursor: pointer; margin-right: 10px; color: #333; }
.header-profile { display: flex; align-items: center; flex: 1; }
.header-profile img { width: 35px; height: 35px; border-radius: 50%; margin-right: 10px; object-fit:cover; background: #eee; }
.header-profile div { display: flex; flex-direction: column; }
.header-name { font-weight: 600; font-size: 14px; }
.header-status { font-size: 11px; color: #28a745; }

/* Área das mensagens */
.mensagens-container {
    flex: 1; overflow-y: auto; padding: 15px; background-color: #fcfcfc;
    display: flex; flex-direction: column; gap: 15px;
}

/* Linha da Mensagem */
.msg-row { display: flex; align-items: flex-end; gap: 8px; max-width: 85%; }

/* Avatar dentro da conversa */
.msg-avatar {
    width: 28px; height: 28px; border-radius: 50%; object-fit: cover;
    flex-shrink: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.1); background: #eee;
}

.msg-bubble {
    padding: 10px 14px; border-radius: 18px;
    font-size: 14px; line-height: 1.4; position: relative; word-wrap: break-word;
}

/* Estilo Recebida */
.msg-row.recebida { align-self: flex-start; }
.msg-row.recebida .msg-bubble { background-color: #e4e6eb; color: #050505; border-bottom-left-radius: 4px; }

/* Estilo Enviada */
.msg-row.enviada { align-self: flex-end; flex-direction: row-reverse; }
.msg-row.enviada .msg-bubble { background-color: #e60050; color: #fff; border-bottom-right-radius: 4px; }

.msg-time { font-size: 9px; margin-top: 4px; text-align: right; opacity: 0.7; }

/* Input Fixo embaixo */
.chat-input-area {
    padding: 10px 15px; border-top: 1px solid #eee; background: #fff;
    display: flex; align-items: center; gap: 10px; padding-bottom: 20px; 
}
.chat-input-area input {
    flex: 1; padding: 12px 15px; border-radius: 25px; border: 1px solid #ddd;
    outline: none; font-family: 'Inter', sans-serif; background: #f0f2f5;
}
.btn-enviar { background: none; border: none; cursor: pointer; color: #e60050; font-weight: bold; font-size: 16px; padding: 5px; }

/* Rodapé */
.barraInferior {
    position: fixed; bottom: 0; left: 0; width: 100%;
    display: flex; justify-content: space-around; align-items: center;
    background-color: #fff; padding: 12px 0; border-top: 1px solid #eee; z-index: 90;
}
.barraInferior img { width: 28px; height: 28px; }

</style>
</head>
<body>

<div id="tela-inbox">
    <div class="header-inbox">
        <h2>Mensagens</h2>
        <img src="https://img.icons8.com/ios/50/000000/create-new.png" class="icon-header" title="Nova mensagem">
    </div>

    <div class="lista-chats">
        
        <div class="chat-item" onclick="abrirConversa('DJ Alex Beat', 'https://i.pinimg.com/1200x/2a/75/70/2a75707b16a2b827f7611e0580bf8ee7.jpg')">
            <img src="https://i.pinimg.com/1200x/2a/75/70/2a75707b16a2b827f7611e0580bf8ee7.jpg" class="avatar">
            <div class="chat-info">
                <div class="chat-nome">DJ Alex Beat</div>
                <div class="chat-preview">Claro! Faço R$ 400 as 4 horas...</div>
            </div>
            <div class="chat-meta">
                <span>10:45</span>
                <div class="badge">1</div>
            </div>
        </div>

        <div class="chat-item" onclick="abrirConversa('Buffet Sabor', 'https://images.pexels.com/photos/1640777/pexels-photo-1640777.jpeg?auto=compress&cs=tinysrgb&w=100')">
            <img src="https://images.pexels.com/photos/1640777/pexels-photo-1640777.jpeg?auto=compress&cs=tinysrgb&w=100" class="avatar">
            <div class="chat-info">
                <div class="chat-nome">Buffet Sabor</div>
                <div class="chat-preview">O cardápio foi enviado no seu email.</div>
            </div>
            <div class="chat-meta">
                <span>Ontem</span>
            </div>
        </div>

    </div>

    <div class="barraInferior">
        <a href="/HTML/home.HTML"><img src="/img/icons8-casa-48.png"></a>
        <a href="/HTML/mapa.html"><img src="/img/icons8-mapa-50.png"></a>
        <a href="/HTML/add.html"><img src="/img/icons8-mais-50.png"></a>
        <a href="/HTML/serv.html"><img src="/img/icons8-parceiro-50.png"></a>
        <a href="/HTML/perfil.html"><img src="/img/icons8-conta-de-teste-50.png"></a>
    </div>
</div>

<div id="tela-conversa">
    <div class="chat-header">
        <button class="btn-voltar" onclick="fecharConversa()">&#8592;</button>
        <div class="header-profile">
            <img id="chat-avatar-atual" src="">
            <div>
                <span class="header-name" id="chat-nome-atual">Nome</span>
                <span class="header-status">Online agora</span>
            </div>
        </div>
        <img src="https://img.icons8.com/ios/50/000000/info--v1.png" class="icon-header">
    </div>

    <div class="mensagens-container" id="container-msgs"></div>

    <div class="chat-input-area">
        <input type="text" id="input-msg" placeholder="Digite uma mensagem..." onkeypress="checarEnter(event)">
        <button class="btn-enviar" onclick="enviarMensagem()">Enviar</button>
    </div>
</div>

<script>
    // --- DADOS ---
    // Pega sua foto (ou usa um padrão se não tiver)
    const minhaFoto = localStorage.getItem("foto") || "https://via.placeholder.com/100";
    let fotoContatoAtual = ""; 

    const telaInbox = document.getElementById('tela-inbox');
    const telaConversa = document.getElementById('tela-conversa');
    const containerMsgs = document.getElementById('container-msgs');
    const inputMsg = document.getElementById('input-msg');

    // Histórico Fake do DJ
    const historicoDJ = [
        { tipo: 'enviada', texto: 'Olá, vi seu perfil no LinkTour!', hora: '10:30' },
        { tipo: 'recebida', texto: 'Opa! Tudo bem? Tenho data livre pro dia 15.', hora: '10:32' },
        { tipo: 'enviada', texto: 'Quanto cobra por 4 horas de festa?', hora: '10:35' },
        { tipo: 'recebida', texto: 'Normalmente é 600, mas faço 400 pra fechar agora!', hora: '10:45' }
    ];

    function abrirConversa(nome, fotoContato) {
        document.getElementById('chat-nome-atual').textContent = nome;
        document.getElementById('chat-avatar-atual').src = fotoContato;
        fotoContatoAtual = fotoContato;

        containerMsgs.innerHTML = '';
        
        if(nome === 'DJ Alex Beat') {
            historicoDJ.forEach(msg => criarBalao(msg.texto, msg.tipo, msg.hora));
        } else {
            criarBalao("Olá! Como posso ajudar?", "recebida", "Agora");
        }

        telaInbox.style.display = 'none';
        telaConversa.style.display = 'flex';
        rolarParaBaixo();
    }

    function fecharConversa() {
        telaConversa.style.display = 'none';
        telaInbox.style.display = 'flex';
    }

    function criarBalao(texto, tipo, hora) {
        // Decide qual foto usar
        const imgAvatar = (tipo === 'recebida') ? fotoContatoAtual : minhaFoto;

        const row = document.createElement('div');
        row.className = `msg-row ${tipo}`;
        
        row.innerHTML = `
            <img src="${imgAvatar}" class="msg-avatar">
            <div class="msg-bubble">
                ${texto}
                <div class="msg-time">${hora}</div>
            </div>
        `;
        containerMsgs.appendChild(row);
    }

    function enviarMensagem() {
        const texto = inputMsg.value.trim();
        if(texto) {
            const horaAtual = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            criarBalao(texto, 'enviada', horaAtual);
            inputMsg.value = '';
            rolarParaBaixo();

            setTimeout(() => {
                
                rolarParaBaixo();
            }, 2000);
        }
    }

    function checarEnter(e) {
        if(e.key === 'Enter') enviarMensagem();
    }

    function rolarParaBaixo() {
        containerMsgs.scrollTop = containerMsgs.scrollHeight;
    }
</script>

</body>
</html>