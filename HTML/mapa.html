<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mapa e Descobrir</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<style>
body, html {
    margin:0;
    padding:0;
    height:100%;
    width:100%;
    font-family: Arial, sans-serif;
    overflow-x:hidden;
}

/* HEADER COM BOTÃ•ES */
header {
    display:flex;
    justify-content:center;
    align-items:center;
    gap:10px;
    padding:10px;
    background:#fff;
    position: sticky;
    top:0;
    z-index:100;
    box-shadow:0 1px 5px rgba(0,0,0,0.1);
}
.headerBtn {
    padding:8px 15px;
    border:none;
    border-radius:20px;
    background:#3b4cca;
    color:#fff;
    font-weight:bold;
    cursor:pointer;
}
.headerBtn.ativo { background:#222; }

/* MAPA */
#mapContainer { display:block; width:100%; height:calc(100vh - 60px - 60px); } 
#map { width:100%; height:100%; }

/* DISCOVER - estilo Pinterest */
#discoverSection {
    display:none;
    column-count: 2;         /* nÃºmero de colunas no mobile */
    column-gap: 12px;
    padding:15px;
}

@media(min-width:600px){
  #discoverSection { column-count: 3; } /* tablets */
}
@media(min-width:900px){
  #discoverSection { column-count: 4; } /* desktop */
}

#discoverSection .card {
    break-inside: avoid;     /* evita corte estranho */
    margin-bottom: 12px;
    cursor:pointer;
    border-radius:12px;
    overflow:hidden;
    background:#fff;
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
}

#discoverSection .card img {
    width:100%;
    height:auto;
    display:block;
    border-radius:12px;
    object-fit:cover;
}

/* MODAL FEED */
.feedModal {
    display:none;
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(255,255,255,0.95);
    z-index:1000;
    flex-direction: column;
    overflow-y:auto;
    justify-content:flex-start;
    padding:20px;
    box-sizing:border-box;
}
.feedHeader {
    display:flex;
    align-items:center;
    padding-bottom:10px;
    border-bottom:1px solid #ddd;
    margin-bottom:10px;
}
.feedBackBtn {
    font-size:24px;
    font-weight:bold;
    cursor:pointer;
    margin-right:10px;
    background:none;
    border:none;
}
.feedContent {
    display:flex;
    flex-direction:column;
    gap:20px;
}

/* POSTS */
.poste {
    border:1px solid #ddd;
    border-radius:12px;
    overflow:hidden;
    background:#fff;
    max-width:500px;
    width:100%;
    margin:0 auto;
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
}
.poste .usuario {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:10px;
}
.poste .usuario .infoUsuario {
    margin-left:10px;
}
.poste .usuario .infoUsuario .nomeUsuario { font-weight:bold; font-size:14px; }
.poste .usuario .infoUsuario .postadoem { font-size:12px; color:gray; }
.poste .fotoPubli img {
    width:100%;
    max-height:300px;
    object-fit:cover;
    border-radius:8px;
}
.poste .desc { font-size:14px; padding:10px; }
.poste .usuario button {
    font-size:13px;
    padding:5px 10px;
    border:none;
    border-radius:5px;
    background:#0095f6;
    color:white;
    cursor:pointer;
}

/* RODAPÃ‰ FIXO */
.barraInferior {
    position: fixed;
    bottom: 0;
    width: 100%;
    display:flex;
    justify-content: space-around;
    align-items:center;
    background-color:#fff;
    padding:12px 0;
    border-top:1px solid #ddd;
    z-index:100;
}
.barraInferior a img { width:30px; height:30px; }
.barraInferior a.ativo img { filter: brightness(1.2); }

/* BLOB MARKER */
.blob {
    width: 50px;
    height: 50px;
    border-radius:100%;
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
    background:#000;
    background-size: 100%;
}
.blob img { width:100%; height:100%; object-fit:cover; }

</style>
</head>
<body>

<header>
  <button id="btnMapa" class="headerBtn ativo">MAPA</button>
  <button id="btnDescobrir" class="headerBtn">DESCOBRIR</button>
</header>

<!-- MAPA -->
<div id="mapContainer">
  <div id="map"></div>
</div>

<!-- DISCOVER -->
<div id="discoverSection">
  <div class="card" data-html='
    <div class="poste">
      <div class="usuario">
        <div style="display:flex; align-items:center;">
          <div class="fotoUsuario"><img src="https://i.pinimg.com/736x/ee/51/24/ee51240828bdd3114b204ef977373353.jpg" style="width:40px;height:40px;border-radius:50%;"></div>
          <div class="infoUsuario">
            <div class="nomeUsuario">Paizao_Imbika_events</div>
            <div class="postadoem">postado hÃ¡ 2hrs</div>
          </div>
        </div>
        <button>Seguir</button>
      </div>
      <div class="fotoPubli">
        <img src="https://i.pinimg.com/1200x/49/7a/83/497a831f5750e97918b869cdc8409484.jpg">
      </div>
      <div class="desc">ðŸ”¥ Vem aÃ­ a melhor festa de Caraguatatuba!</div>
    </div>
  '><img src="https://i.pinimg.com/1200x/49/7a/83/497a831f5750e97918b869cdc8409484.jpg" alt="" style="width: 100%; height: 100%; border-radius: 0;"></div>

  <div class="card" data-html='
    <div class="poste">
      <div class="usuario">
        <div style="display:flex; align-items:center;">
          <div class="fotoUsuario"><img src="https://i.pinimg.com/736x/a3/1f/29/a31f29d05c70a414f1d2f1619c9f190f.jpg" style="width:40px;height:40px;border-radius:50%;"></div>
          <div class="infoUsuario">
            <div class="nomeUsuario">Eventos_Litoral</div>
            <div class="postadoem">postado hÃ¡ 5hrs</div>
          </div>
        </div>
        <button>Seguir</button>
      </div>
      <div class="fotoPubli">
        <img src="https://i.pinimg.com/736x/d8/93/2b/d8932bf5bdb46462182e409a8882301a.jpg">
      </div>
      <div class="desc">ðŸŒŠ Sunset incrÃ­vel no litoral!</div>
    </div>
  '><img src="https://i.pinimg.com/736x/d8/93/2b/d8932bf5bdb46462182e409a8882301a.jpg" alt="" style="width: 100%; height: 100%; border-radius: 0;"> </div>
</div>

<!-- MODAL FEED -->
<div id="feedModal" class="feedModal">
  <div class="feedHeader">
    <button id="feedBackBtn" class="feedBackBtn">&#8592;</button>
    <span>Explorar</span>
  </div>
  <div class="feedContent" id="feedModalInner"></div>
</div>

<!-- RODAPÃ‰ -->
<div class="barraInferior">
  <a href="/HTML/home.HTML"><img src="/img/icons8-casa-48.png" alt=""></a>
  <a href="/HTML/mapa.html"><img src="/img/icons8-mapa-50.png" alt=""></a>
  <a href="/HTML/add.html"><img src="/img/icons8-mais-50.png" alt=""></a>
  <a href="/HTML/serv.html" class="ativo"><img src="/img/icons8-parceiro-50.png" alt=""></a>
  <a href="/HTML/perfil.html"><img src="/img/icons8-conta-de-teste-50.png" alt=""></a>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
const mapContainer = document.getElementById('mapContainer');
const discoverSection = document.getElementById('discoverSection');
const btnMapa = document.getElementById('btnMapa');
const btnDescobrir = document.getElementById('btnDescobrir');

// Alternar abas
btnMapa.addEventListener('click', ()=>{
    mapContainer.style.display='block';
    discoverSection.style.display='none';
    btnMapa.classList.add('ativo');
    btnDescobrir.classList.remove('ativo');
});
btnDescobrir.addEventListener('click', ()=>{
    mapContainer.style.display='none';
    discoverSection.style.display='flex';
    btnDescobrir.classList.add('ativo');
    btnMapa.classList.remove('ativo');
});

// Mapa centralizado
var map = L.map('map').setView([-23.6226, -45.4167], 13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: 'Â© OpenStreetMap'
}).addTo(map);

// FunÃ§Ã£o para criar blob marker
function blobMarker(lat, lng, imgUrl, publiHtml){
    return L.marker([lat,lng],{
        icon: L.divIcon({
            className:"",
            html:`<div class="blob"><img src="${imgUrl}"></div>`,
            iconSize:[50,50],
            iconAnchor:[25,25]
        })
    }).addTo(map).on('click',()=>openFeed(publiHtml));
}

// PublicaÃ§Ãµes Home
const publi1 = document.querySelector('#discoverSection .card:nth-child(1)').dataset.html;
const publi2 = document.querySelector('#discoverSection .card:nth-child(2)').dataset.html;

// Blobs no mapa
blobMarker(-23.636731, -45.430425, "https://i.pinimg.com/1200x/49/7a/83/497a831f5750e97918b869cdc8409484.jpg", publi1);
blobMarker(-23.629219, -45.415384, "https://i.pinimg.com/736x/d8/93/2b/d8932bf5bdb46462182e409a8882301a.jpg", publi2);

// Modal Feed
const feedModal = document.getElementById('feedModal');
const feedModalInner = document.getElementById('feedModalInner');
const feedBackBtn = document.getElementById('feedBackBtn');

function openFeed(html){
    feedModalInner.innerHTML = html;
    feedModal.style.display = 'flex';
    document.body.style.overflow='hidden';
}

function closeFeed(){
    feedModal.style.display='none';
    document.body.style.overflow='auto';
}

feedBackBtn.addEventListener('click',closeFeed);

// Clique nos cards do Discover
const discoverCards = document.querySelectorAll('#discoverSection .card');
discoverCards.forEach(card=>{
    card.addEventListener('click',()=>openFeed(card.dataset.html));
});
</script>
</body>
</html>
